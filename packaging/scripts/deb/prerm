#!/bin/sh
set -eu

systemd_active() {
  if ! command -v systemctl >/dev/null 2>&1; then
    return 1
  fi

  if [ ! -S /run/systemd/private ]; then
    return 1
  fi

  return 0
}

case "$1" in
  remove)
    if systemd_active; then
      if ! systemctl --no-reload stop clusterrebootd.service; then
        echo "warning: failed to stop clusterrebootd.service" >&2
      fi
    fi
    ;;
  *)
    ;;
esac

exit 0
